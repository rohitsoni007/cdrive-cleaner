@echo off
title Ultra Deep Clean Utility (FAST MODE)
color 0A
setlocal

echo ==============================================
echo        Ultra Deep Clean Utility (FAST)
echo ==============================================
echo User: %USERNAME%
echo ==============================================
pause

:: Admin check
net session >nul 2>&1
if %errorlevel% neq 0 (
    echo Please run as Administrator.
    pause
    exit /b
)

echo.
echo Stopping Windows Update services...
net stop wuauserv >nul 2>&1
net stop bits >nul 2>&1

echo.
echo Starting FAST cleanup...
echo.

:: ================================
:: CONTENT CLEAN
:: ================================
for %%F in (
{{#each contentClean}}
"{{this}}"
{{/each}}
) do (
    if exist "%%F" (
        echo Cleaning contents: %%F
        del /f /s /q "%%F\*" >nul 2>&1
        for /d %%D in ("%%F\*") do rd /s /q "%%D" >nul 2>&1
    )
)

:: ================================
:: UV SPECIAL
:: ================================
taskkill /f /im uv.exe >nul 2>&1
timeout /t 1 >nul

if exist "{{uvPath}}" (
    move "{{uvPath}}" "%TEMP%\uv_delete_%RANDOM%" >nul 2>&1
    rd /s /q "%TEMP%\uv_delete_%RANDOM%" >nul 2>&1
)

:: ================================
:: FULL REMOVE
:: ================================
for %%F in (
{{#each fullRemove}}
"{{this}}"
{{/each}}
) do (
    if exist "%%F" (
        echo Removing: %%F
        rd /s /q "%%F" >nul 2>&1
    )
)

echo.
echo Restarting Windows Update services...
net start wuauserv >nul 2>&1
net start bits >nul 2>&1

echo.
echo FAST CLEANUP COMPLETED
pause
exit /b